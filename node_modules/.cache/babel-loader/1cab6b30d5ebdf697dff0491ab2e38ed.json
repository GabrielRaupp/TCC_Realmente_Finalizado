{"ast":null,"code":"import{useState,useEffect}from'react';import Container from'../layout/Container';import Loading from'../layout/Loading';import LinkButton from'../layout/LinkButton';import HorarioCard from'../horario/HorarioCard';import Message from'../layout/Message';import styles from'./Horarios.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Horarios(){const[horarios,setHorarios]=useState([]);const[removeLoading,setRemoveLoading]=useState(false);const[horarioMessage,setHorarioMessage]=useState('');const[errorMessage,setErrorMessage]=useState('');useEffect(()=>{const fetchData=async()=>{try{const response=await fetch('http://localhost:3000/horarios',{credentials:'same-origin'});if(!response.ok){throw new Error('Erro ao buscar horários');}const data=await response.json();console.log('Horários recebidos:',data);// Ordena os horários por data/hora\nconst sortedHorarios=data.sort((a,b)=>{const dateA=new Date(a.horarios);const dateB=new Date(b.horarios);return dateA-dateB;});setHorarios(sortedHorarios);}catch(error){console.error(\"Erro ao buscar horários:\",error);setErrorMessage(error.message);}finally{setRemoveLoading(true);}};fetchData();},[]);const removeHorario=async id=>{try{const response=await fetch(`http://localhost:3000/horario/${id}`,{method:'DELETE',headers:{'Content-Type':'application/json'},credentials:'same-origin'});if(!response.ok){throw new Error('Erro ao remover horário');}setHorarios(prevHorarios=>prevHorarios.filter(horario=>horario._id!==id));setHorarioMessage('Horário removido com sucesso!');}catch(error){console.error(\"Erro ao remover horário:\",error);setErrorMessage(error.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.title_container,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Meus Hor\\xE1rios\"}),/*#__PURE__*/_jsx(LinkButton,{to:\"/newhorario\",text:\"Montar hor\\xE1rio\",customClass:styles.addHorarioButton})]}),horarioMessage&&/*#__PURE__*/_jsx(Message,{type:\"success\",msg:horarioMessage}),errorMessage&&/*#__PURE__*/_jsx(Message,{type:\"error\",msg:errorMessage}),/*#__PURE__*/_jsx(Container,{customClass:styles.container,children:horarios.length>0?horarios.map(horario=>/*#__PURE__*/_jsx(HorarioCard,{id:horario._id,name:horario.name,horario:horario.horarios,category:horario.category||'Sem categoria',handleRemove:removeHorario,customClass:styles.horarioCard},horario._id)):!removeLoading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsx(\"p\",{children:\"N\\xE3o h\\xE1 hor\\xE1rios cadastrados!\"})})]});}export default Horarios;","map":{"version":3,"names":["useState","useEffect","Container","Loading","LinkButton","HorarioCard","Message","styles","jsx","_jsx","jsxs","_jsxs","Horarios","horarios","setHorarios","removeLoading","setRemoveLoading","horarioMessage","setHorarioMessage","errorMessage","setErrorMessage","fetchData","response","fetch","credentials","ok","Error","data","json","console","log","sortedHorarios","sort","a","b","dateA","Date","dateB","error","message","removeHorario","id","method","headers","prevHorarios","filter","horario","_id","className","container","children","title_container","to","text","customClass","addHorarioButton","type","msg","length","map","name","category","handleRemove","horarioCard"],"sources":["/home/redes/Gabriel_Raupp/TCC_90-FEITO/src/components/pages/Horarios.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport Container from '../layout/Container';\nimport Loading from '../layout/Loading';\nimport LinkButton from '../layout/LinkButton';\nimport HorarioCard from '../horario/HorarioCard';\nimport Message from '../layout/Message';\nimport styles from './Horarios.module.css';\n\nfunction Horarios() {\n  const [horarios, setHorarios] = useState([]);\n  const [removeLoading, setRemoveLoading] = useState(false);\n  const [horarioMessage, setHorarioMessage] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await fetch('http://localhost:3000/horarios', {\n          credentials: 'same-origin',\n        });\n\n        if (!response.ok) {\n          throw new Error('Erro ao buscar horários');\n        }\n\n        const data = await response.json();\n        console.log('Horários recebidos:', data);  \n        \n        // Ordena os horários por data/hora\n        const sortedHorarios = data.sort((a, b) => {\n          const dateA = new Date(a.horarios); \n          const dateB = new Date(b.horarios);\n          return dateA - dateB; \n        });\n\n        setHorarios(sortedHorarios);\n      } catch (error) {\n        console.error(\"Erro ao buscar horários:\", error);\n        setErrorMessage(error.message);\n      } finally {\n        setRemoveLoading(true);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  const removeHorario = async (id) => {\n    try {\n      const response = await fetch(`http://localhost:3000/horario/${id}`, {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'same-origin',\n      });\n\n      if (!response.ok) {\n        throw new Error('Erro ao remover horário');\n      }\n\n      setHorarios((prevHorarios) => prevHorarios.filter((horario) => horario._id !== id));\n      setHorarioMessage('Horário removido com sucesso!');\n    } catch (error) {\n      console.error(\"Erro ao remover horário:\", error);\n      setErrorMessage(error.message);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.title_container}>\n        <h1>Meus Horários</h1>\n        <LinkButton to=\"/newhorario\" text=\"Montar horário\" customClass={styles.addHorarioButton} />\n      </div>\n      {horarioMessage && <Message type=\"success\" msg={horarioMessage} />}\n      {errorMessage && <Message type=\"error\" msg={errorMessage} />}\n      <Container customClass={styles.container}>\n        {horarios.length > 0 ? (\n          horarios.map((horario) => (\n            <HorarioCard\n              id={horario._id}\n              name={horario.name}\n              horario={horario.horarios}\n              category={horario.category || 'Sem categoria'}\n              key={horario._id}\n              handleRemove={removeHorario}\n              customClass={styles.horarioCard}\n            />\n          ))\n        ) : (\n          !removeLoading ? <Loading /> : <p>Não há horários cadastrados!</p>\n        )}\n      </Container>\n    </div>\n  );\n}\n\nexport default Horarios;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}